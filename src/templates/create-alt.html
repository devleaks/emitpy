{% extends 'base.html' %}
{% from 'bootstrap5/form.html' import render_form, render_field, render_form_row %}

{% block content %}

    <h2>{{ title }}</h2>

    {{ render_form(create_form) }}

    <script>
        let move_select = document.getElementById("movement_id")
        let sync_select = document.getElementById("syncname_id")
        move_select.onchange = function() {
            move_id = move_select.value;
            fetch('/emitsyncs/'+move_id).then(function(response){
                response.json().then(function(data) {
                    let optionHTML = '';
                    for(let sn of data.syncs) {
                        optionHTML += '<option value="'+sn[0]+'">'+sn[1]+'</option>'
                    }
                    sync_select.innerHTML = optionHTML
                })
            })
        }
        if(document.createEvent) { // provoke event for first init
            let event = document.createEvent("HTMLEvents");
            event.initEvent("change", true, true);
            event.eventName = "change";
            move_select.dispatchEvent(event);
        }
    </script>

{% endblock %}